#!/bin/bash

echo Start $(date)

if [ ! -d /media/external/backups ]; then
	echo Creating directories
	sudo mkdir /media/external/backups
fi

today="$(date +%u)"

if [ -n "$(docker ps -f "name=pihole" -f "status=running" -q)" ]; then
	echo Runing PiHole Teleport
	docker exec pihole pihole -a -t /etc/pihole/teleport.tar.gz
	sudo mv $DOCKER_VOLUMES/pihole-stack_pihole/_data/teleport.tar.gz /media/external/backups/teleport.tar.gz
else
	echo Skipping Pi-Hole steps. Pi-Hole is not running!!
fi

echo Backing up Home Directories
sudo tar -zcf /media/external/backups/docker.tgz /home/jcrocker/src/all-things-docker
sudo tar -zcf /media/external/backups/docker-private.tgz /home/jcrocker/docker-private
sudo tar -zcf /media/external/backups/scripts.tgz /home/jcrocker/src/all-things-linux-bash

sudo tar -zcf /media/external/backups/filebrowser.tgz /media/filebrowser


echo Finish $(date)
